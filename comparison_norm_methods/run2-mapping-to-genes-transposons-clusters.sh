#!/usr/bin/env bash

source /home/fuy2/repo/tools/piPipes_aux/global.sh

# for D in $(sed 's/.fq.gz//' filenames.txt); do
# for D in SRS.42A18AT1.br1.tr1.ox.ovary SRS.42A18AT1.br2.tr1.ox.ovary	 SRS.42A18AT1.br3.tr1.ox.ovary	 SRS.42A18AT1.br4.tr1.ox.ovary	 SRS.42A18AT1.br4.tr2.ox.ovary	 SRS.GS1AT1.br1.tr1.ox.ovary	 SRS.GS1AT1.br2.tr1.ox.ovary	 SRS.GS1AT1.br3.tr1.ox.ovary	 SRS.42A18BT1.br1.tr1.ox.ovary	 SRS.42A18BT1.br1.tr2.ox.ovary	 SRS.42A18BT1.br2.tr1.ox.ovary	 SRS.42A18BT1.br3.tr1.ox.ovary	 SRS.GS1BT1.br1.tr1.ox.ovary	 SRS.GS1BT1.br2.tr1.ox.ovary	 SRS.GS1BT1.br3.tr1.ox.ovary	 SRS.42A18CT1.br1.tr1.ox.ovary	 SRS.42A18CT1.br2.tr1.ox.ovary	 SRS.42A18CT1.br3.tr1.ox.ovary	 SRS.GS1CT1.br1.tr1.ox.ovary	 SRS.GS1CT1.br2.tr1.ox.ovary	 SRS.GS1CT1.br3.tr1.ox.ovary	 SRS.GS1CT1.br3.tr2.ox.ovary; do
# for D in SRS.42A18AT1.br1.tr1.ox.ovary SRS.42A18AT1.br2.tr1.ox.ovary SRS.42A18AT1.br3.tr1.ox.ovary SRS.42A18AT1.br4.tr1_2.ox.ovary SRS.42A18AT1.br4.tr1.ox.ovary SRS.42A18AT1.br4.tr2.ox.ovary SRS.42A18BT1.br1.tr1_2.ox.ovary SRS.42A18BT1.br1.tr1.ox.ovary SRS.42A18BT1.br1.tr2.ox.ovary SRS.42A18BT1.br2.tr1.ox.ovary SRS.42A18BT1.br3.tr1.ox.ovary SRS.42A18CT1.br1.tr1.ox.ovary SRS.42A18CT1.br2.tr1.ox.ovary SRS.42A18CT1.br3.tr1.ox.ovary SRS.42A18.F18.br1.tr1.ox.ovary SRS.42A18.F18.br2.tr1_2.ox.ovary SRS.42A18.F18.br2.tr1.ox.ovary SRS.42A18.F18.br2.tr2.ox.ovary SRS.42A18.F18.br3.tr1.ox.ovary SRS.42A18.F1.br1.tr1.ox.ovary SRS.42A18.F1.br2.tr1_2.ox.ovary SRS.42A18.F1.br2.tr1.ox.ovary SRS.42A18.F1.br2.tr2.ox.ovary SRS.42A18.F1.br3.tr1_2.ox.ovary SRS.42A18.F1.br3.tr1.ox.ovary SRS.42A18.F1.br3.tr2.ox.ovary SRS.42A18HT1.Ago3IP.br1.tr1_2.ox.ovary SRS.42A18HT1.Ago3IP.br1.tr1.ox.ovary SRS.42A18HT1.Ago3IP.br1.tr2.ox.ovary SRS.42A18HT1.AubIP.br1.tr1_2.ox.ovary SRS.42A18HT1.AubIP.br1.tr1.ox.ovary SRS.42A18HT1.AubIP.br1.tr2.ox.ovary SRS.42A18HT1.PiwiIP.br1.tr1_2.ox.ovary SRS.42A18HT1.PiwiIP.br1.tr1.ox.ovary SRS.42A18HT1.PiwiIP.br1.tr2.ox.ovary SRS.42ABPol2ex11_BL24351.br1.tr1.ox.ovary SRS.42ABPol2ex17.br1.tr1.ox.ovary SRS.42ABPol2ex28.br1.tr1.ox.ovary SRS.42ABPol2ex3_BL24351.br1.tr1.ox.ovary SRS.42ABPol2ex3_ex11.br1.tr1.ox.ovary SRS.AC1.br1.tr1.ox.ovary SRS.BC1.br1.tr1.ox.ovary SRS.BL200612.br1.tr1.ox.ovary SRS.BL206237.br1.tr1.ox.ovary SRS.BL27781.br1.tr1.ox.ovary SRS.BL35885.br1.tr1_2.ox.ovary SRS.BL35885.br1.tr1.ox.ovary SRS.BL35885.br1.tr2.ox.ovary SRS.BL37218.br1.tr1.ox.ovary SRS.BL38092.br1.tr1.ox.ovary SRS.CC1.Ago3IP.br1.tr1_2.ox.ovary SRS.CC1.Ago3IP.br1.tr1.ox.ovary SRS.CC1.Ago3IP.br1.tr2.ox.ovary SRS.CC1.AubIP.br1.tr1_2.ox.ovary SRS.CC1.AubIP.br1.tr1.ox.ovary SRS.CC1.AubIP.br1.tr2.ox.ovary SRS.CC1.br1.tr1.ox.ovary SRS.CC1.PiwiIP.br1.tr1_2.ox.ovary SRS.CC1.PiwiIP.br1.tr1.ox.ovary SRS.CC1.PiwiIP.br1.tr2.ox.ovary SRS.CC2.br1.tr1.ox.ovary SRS.CC3.br1.tr1_2.ox.ovary SRS.CC3.br1.tr1.ox.ovary SRS.CC3.br1.tr2.ox.ovary SRS.CC4.br1.tr1.ox.ovary SRS.DC1.br1.tr1.ox.ovary SRS.GS1AT1.br1.tr1.ox.ovary SRS.GS1AT1.br1.tr1.unox.ovary SRS.GS1AT1.br2.tr1.ox.ovary SRS.GS1AT1.br3.tr1.ox.ovary SRS.GS1BT1.28_31d.br1.tr1_2.ox.ovary SRS.GS1BT1.28_31d.br1.tr1.ox.ovary SRS.GS1BT1.28_31d.br1.tr2.ox.ovary SRS.GS1BT1.28_31d.br2.tr1_2.ox.ovary SRS.GS1BT1.28_31d.br2.tr1.ox.ovary SRS.GS1BT1.28_31d.br2.tr2.ox.ovary SRS.GS1BT1.28_31d.br3.tr1_2.ox.ovary SRS.GS1BT1.28_31d.br3.tr1.ox.ovary SRS.GS1BT1.28_31d.br3.tr2.ox.ovary SRS.GS1BT1.br1.tr1.ox.ovary SRS.GS1BT1.br2.tr1.ox.ovary SRS.GS1BT1.br3.tr1.ox.ovary SRS.GS1CT1.Ago3IP.br1.tr1_2.ox.ovary SRS.GS1CT1.Ago3IP.br1.tr1.ox.ovary SRS.GS1CT1.Ago3IP.br1.tr2.ox.ovary SRS.GS1CT1.AubIP.br1.tr1_2.ox.ovary SRS.GS1CT1.AubIP.br1.tr1.ox.ovary SRS.GS1CT1.AubIP.br1.tr2.ox.ovary SRS.GS1CT1.br1.tr1.ox.ovary SRS.GS1CT1.br2.tr1.ox.ovary SRS.GS1CT1.br3.tr1_2.ox.ovary SRS.GS1CT1.br3.tr1.ox.ovary SRS.GS1CT1.br3.tr2.ox.ovary SRS.GS1CT1.PiwiIP.br1.tr1_2.ox.ovary SRS.GS1CT1.PiwiIP.br1.tr1.ox.ovary SRS.GS1CT1.PiwiIP.br1.tr2.ox.ovary SRS.GS1CT2.br1.tr1.ox.ovary SRS.GS1CT3.br1.tr1.ox.ovary SRS.GS1CT4.br1.tr1.ox.ovary SRS.GS1DT1.br1.tr1_2.ox.ovary SRS.GS1DT1.br1.tr1.ox.ovary SRS.GS1DT1.br1.tr2.ox.ovary SRS.GS1DT1.br2.tr1.ox.ovary SRS.GS1DT1.br3.tr1.ox.ovary SRS.GS1ET1.br1.tr1.ox.ovary SRS.GS1ET1.br2.tr1.ox.ovary SRS.GS1ET1.br3.tr1.ox.ovary SRS.GS1.F18.br1.tr1.ox.ovary SRS.GS1.F18.br2.tr1_2.ox.ovary SRS.GS1.F18.br2.tr1.ox.ovary SRS.GS1.F18.br2.tr2.ox.ovary SRS.GS1.F18.br3.tr1.ox.ovary SRS.GS1.F1.br1.tr1.ox.ovary SRS.GS1.F1.br2.tr1_2.ox.ovary SRS.GS1.F1.br2.tr1.ox.ovary SRS.GS1.F1.br2.tr2.ox.ovary SRS.GS1.F1.br3.tr1_2.ox.ovary SRS.GS1.F1.br3.tr1.ox.ovary SRS.GS1.F1.br3.tr2.ox.ovary SRS.GS1FT1.br1.tr1.ox.ovary SRS.GS1FT1.br2.tr1.ox.ovary SRS.GS1FT1.br3.tr1_2.ox.ovary SRS.GS1FT1.br3.tr1.ox.ovary SRS.GS1FT1.br3.tr2.ox.ovary SRS.GS1GT1.br1.tr1.ox.ovary SRS.GS1GT1.br2.tr1.ox.ovary SRS.GS1GT1.br3.tr1.ox.ovary SRS.GS1HT1.Ago3IP.br1.tr1_2.ox.ovary SRS.GS1HT1.Ago3IP.br1.tr1.ox.ovary SRS.GS1HT1.Ago3IP.br1.tr2.ox.ovary SRS.GS1HT1.AubIP.br1.tr1_2.ox.ovary SRS.GS1HT1.AubIP.br1.tr1.ox.ovary SRS.GS1HT1.AubIP.br1.tr2.ox.ovary SRS.GS1HT1.PiwiIP.br1.tr1_2.ox.ovary SRS.GS1HT1.PiwiIP.br1.tr1.ox.ovary SRS.GS1HT1.PiwiIP.br1.tr2.ox.ovary SRS.GS1JT1.br1.tr1.ox.ovary SRS.GS1JT1.br2.tr1.ox.ovary SRS.GS1JT1.br3.tr1.ox.ovary SRS.GS1JT2.br1.tr1.ox.ovary SRS.GS1JT2.br2.tr1.ox.ovary SRS.GS1JT2.br3.tr1.ox.ovary SRS.GS1JT3.br1.tr1.ox.ovary SRS.GS1JT3.br2.tr1.ox.ovary SRS.GS1JT3.br3.tr1.ox.ovary SRS.GS1JT4.br1.tr1.ox.ovary SRS.GS1JT4.br2.tr1.ox.ovary SRS.GS1JT4.br3.tr1.ox.ovary SRS.OR.br1.tr1_2.unox.testes SRS.OR.br1.tr1.ox.testes SRS.OR.br1.tr1.unox.testes SRS.OR.br1.tr2.unox.testes SRS.plus.F18.br1.tr1.ox.ovary SRS.plus.F1.br1.tr1.ox.ovary SRS.SRS53.3.br1.tr1.unox.ovary SRS.w1.BL104630.br1.tr1.ox.ovary SRS.w1.BL203022.br1.tr1.ox.ovary SRS.w1.BL203560_CyO.br1.tr1.ox.ovary SRS.w1.BL20969.br1.tr1.ox.ovary SRS.w1.BL22348_CyO.br1.tr1.ox.ovary SRS.w1.BL24062.br1.tr1.ox.ovary SRS.XO.br1.tr1.ox.testes SRS.XO.br2.tr1_2.ox.testes SRS.XO.br2.tr1.ox.testes SRS.XO.br2.tr2.ox.testes SRS.XO.br3.tr1_2.ox.testes SRS.XO.br3.tr1.ox.testes SRS.XO.br3.tr2.ox.testes SRS.XO.br4.tr1_2.ox.testes SRS.XO.br4.tr1.ox.testes SRS.XO.br4.tr2.ox.testes SRS.ZIPAT1.br1.tr1.ox.ovary SRS.ZIPBT1.br1.tr1.ox.ovary SRS.ZIPCT1.br1.tr1.ox.ovary SRS.ZIP.F18.br1.tr1.ox.ovary SRS.ZIP.F1.br1.tr1.ox.ovary SRS.ZIPHT1.Ago3IP.br1.tr1.ox.ovary SRS.ZIPHT1.AubIP.br1.tr1.ox.ovary SRS.ZIPHT1.PiwiIP.br1.tr1.ox.ovary; do
for D in SRS.42A18.F18.br1.tr1.ox.ovary SRS.42A18.F18.br2.tr1.ox.ovary SRS.42A18.F18.br2.tr2.ox.ovary SRS.42A18.F18.br3.tr1.ox.ovary SRS.42A18.F1.br1.tr1.ox.ovary SRS.42A18.F1.br2.tr1.ox.ovary SRS.42A18.F1.br2.tr2.ox.ovary SRS.42A18.F1.br3.tr1.ox.ovary SRS.42A18.F1.br3.tr2.ox.ovary SRS.42A18HT1.Ago3IP.br1.tr1.ox.ovary SRS.42A18HT1.Ago3IP.br1.tr2.ox.ovary SRS.42A18HT1.AubIP.br1.tr1.ox.ovary SRS.42A18HT1.AubIP.br1.tr2.ox.ovary SRS.42A18HT1.PiwiIP.br1.tr1.ox.ovary SRS.42A18HT1.PiwiIP.br1.tr2.ox.ovary SRS.CC1.Ago3IP.br1.tr1.ox.ovary SRS.CC1.Ago3IP.br1.tr2.ox.ovary SRS.CC1.AubIP.br1.tr1.ox.ovary SRS.CC1.AubIP.br1.tr2.ox.ovary SRS.CC1.PiwiIP.br1.tr1.ox.ovary SRS.CC1.PiwiIP.br1.tr2.ox.ovary SRS.CC3.br1.tr1.ox.ovary SRS.CC3.br1.tr2.ox.ovary SRS.GS1AT1.br1.tr1.ox.ovary SRS.GS1AT1.br2.tr1.ox.ovary SRS.GS1AT1.br3.tr1.ox.ovary SRS.GS1BT1.28_31d.br1.tr1.ox.ovary SRS.GS1BT1.28_31d.br1.tr2.ox.ovary SRS.GS1BT1.28_31d.br2.tr1.ox.ovary SRS.GS1BT1.28_31d.br2.tr2.ox.ovary SRS.GS1BT1.28_31d.br3.tr1.ox.ovary SRS.GS1BT1.28_31d.br3.tr2.ox.ovary SRS.GS1BT1.br1.tr1.ox.ovary SRS.GS1BT1.br2.tr1.ox.ovary SRS.GS1BT1.br3.tr1.ox.ovary SRS.GS1CT1.Ago3IP.br1.tr1.ox.ovary SRS.GS1CT1.Ago3IP.br1.tr2.ox.ovary SRS.GS1CT1.AubIP.br1.tr1.ox.ovary SRS.GS1CT1.AubIP.br1.tr2.ox.ovary SRS.GS1CT1.br1.tr1.ox.ovary SRS.GS1CT1.br2.tr1.ox.ovary SRS.GS1CT1.br3.tr1.ox.ovary SRS.GS1CT1.br3.tr2.ox.ovary SRS.GS1CT1.PiwiIP.br1.tr1.ox.ovary SRS.GS1CT1.PiwiIP.br1.tr2.ox.ovary SRS.GS1DT1.br1.tr1.ox.ovary SRS.GS1DT1.br1.tr2.ox.ovary SRS.GS1DT1.br2.tr1.ox.ovary SRS.GS1DT1.br3.tr1.ox.ovary SRS.GS1ET1.br1.tr1.ox.ovary SRS.GS1ET1.br2.tr1.ox.ovary SRS.GS1ET1.br3.tr1.ox.ovary SRS.GS1.F18.br1.tr1.ox.ovary SRS.GS1.F18.br2.tr1.ox.ovary SRS.GS1.F18.br2.tr2.ox.ovary SRS.GS1.F18.br3.tr1.ox.ovary SRS.GS1.F1.br1.tr1.ox.ovary SRS.GS1.F1.br2.tr1.ox.ovary SRS.GS1.F1.br2.tr2.ox.ovary SRS.GS1.F1.br3.tr1.ox.ovary SRS.GS1.F1.br3.tr2.ox.ovary SRS.GS1FT1.br1.tr1.ox.ovary SRS.GS1FT1.br2.tr1.ox.ovary SRS.GS1FT1.br3.tr1.ox.ovary SRS.GS1FT1.br3.tr2.ox.ovary SRS.GS1GT1.br1.tr1.ox.ovary SRS.GS1GT1.br2.tr1.ox.ovary SRS.GS1GT1.br3.tr1.ox.ovary SRS.GS1HT1.Ago3IP.br1.tr1.ox.ovary SRS.GS1HT1.Ago3IP.br1.tr2.ox.ovary SRS.GS1HT1.AubIP.br1.tr1.ox.ovary SRS.GS1HT1.AubIP.br1.tr2.ox.ovary SRS.GS1HT1.PiwiIP.br1.tr1.ox.ovary SRS.GS1HT1.PiwiIP.br1.tr2.ox.ovary SRS.GS1JT1.br1.tr1.ox.ovary SRS.GS1JT1.br2.tr1.ox.ovary SRS.GS1JT1.br3.tr1.ox.ovary SRS.GS1JT2.br1.tr1.ox.ovary SRS.GS1JT2.br2.tr1.ox.ovary SRS.GS1JT2.br3.tr1.ox.ovary SRS.GS1JT3.br1.tr1.ox.ovary SRS.GS1JT3.br2.tr1.ox.ovary SRS.GS1JT3.br3.tr1.ox.ovary SRS.GS1JT4.br1.tr1.ox.ovary SRS.GS1JT4.br2.tr1.ox.ovary SRS.GS1JT4.br3.tr1.ox.ovary SRS.GS1AT1.br1.tr1.ox.ovary SRS.GS1AT1.br1.tr1.unox.ovary SRS.OR.br1.tr1.ox.testes SRS.OR.br1.tr1.unox.testes SRS.OR.br1.tr2.unox.testes SRS.XO.br1.tr1.ox.testes SRS.XO.br2.tr1.ox.testes SRS.XO.br2.tr2.ox.testes SRS.XO.br3.tr1.ox.testes SRS.XO.br3.tr2.ox.testes SRS.XO.br4.tr1.ox.testes SRS.XO.br4.tr2.ox.testes; do
    # D=SRS.GS1CT1.br1.tr1.ox.ovary
    PREFIX=$D
    OUTPUT_D=${D}/gene+cluster+repBase
    mkdir -p ${OUTPUT_D}
    
    INPUT=/home/fuy2/data/gfp_pirna/data/${D}/input_read_files/${D}.x_rRNA.insert
    source ~/data/piPipes/common/dm3/variables
    
    CPU=8
    GENOME=genes+cluster+repBase
    GCR_IDX=~/data/piPipes/common/dm3_chengjian/BowtieIndex/gene+cluster+repBase

    GCR_ALLMAP_LOG=${OUTPUT_D}/${PREFIX}.gene+cluster+repBase.log
    GCR_ALLMAP_BED2=${OUTPUT_D}/${PREFIX}.gene+cluster+repBase.bed2
    ## echo "!!!" && echo ${GCR_ALLMAP_BED2}
    
    echo "bowtie -r -v $genome_MM -a --best --strata -p $CPU \
       -S \
       ${GCR_IDX} \
       ${INPUT} \
       2> $GCR_ALLMAP_LOG | \
	samtools view -uS -F0x4 - 2>/dev/null | \
	${BEDTOOLS} bamtobed -i - > ${OUTPUT_D}/${PREFIX}.${GENOME}v${genome_MM}a.insert.bed && \
	${INSERT_BED_TO_BED2} $INPUT ${OUTPUT_D}/${PREFIX}.${GENOME}v${genome_MM}a.insert.bed > ${GCR_ALLMAP_BED2} && \
	rm -rf ${INSERT%.insert}.${GENOME}v${genome_MM}a.insert.bed"

done
