#!/usr/bin/env bash

# for D in SRS.GS1CT1.br1.tr1.ox.ovary SRS.GS1CT1.br2.tr1.ox.ovary SRS.GS1CT1.br3.tr1_2.ox.ovary SRS.GS1CT1.br3.tr1.ox.ovary SRS.GS1CT1.br3.tr2.ox.ovary; do
# for D in SRS.42A18AT1.br1.tr1.ox.ovary SRS.42A18AT1.br2.tr1.ox.ovary SRS.42A18AT1.br3.tr1.ox.ovary SRS.42A18AT1.br4.tr1.ox.ovary SRS.42A18AT1.br4.tr2.ox.ovary SRS.GS1AT1.br1.tr1.ox.ovary SRS.GS1AT1.br2.tr1.ox.ovary SRS.GS1AT1.br3.tr1.ox.ovary SRS.42A18BT1.br1.tr1.ox.ovary SRS.42A18BT1.br1.tr2.ox.ovary SRS.42A18BT1.br2.tr1.ox.ovary SRS.42A18BT1.br3.tr1.ox.ovary SRS.GS1BT1.br1.tr1.ox.ovary SRS.GS1BT1.br2.tr1.ox.ovary SRS.GS1BT1.br3.tr1.ox.ovary SRS.42A18CT1.br1.tr1.ox.ovary SRS.42A18CT1.br2.tr1.ox.ovary SRS.42A18CT1.br3.tr1.ox.ovary SRS.GS1CT1.br1.tr1.ox.ovary SRS.GS1CT1.br2.tr1.ox.ovary SRS.GS1CT1.br3.tr1.ox.ovary SRS.GS1CT1.br3.tr2.ox.ovary; do
for D in SRS.42A18.F18.br1.tr1.ox.ovary SRS.42A18.F18.br2.tr1.ox.ovary SRS.42A18.F18.br2.tr2.ox.ovary SRS.42A18.F18.br3.tr1.ox.ovary SRS.42A18.F1.br1.tr1.ox.ovary SRS.42A18.F1.br2.tr1.ox.ovary SRS.42A18.F1.br2.tr2.ox.ovary SRS.42A18.F1.br3.tr1.ox.ovary SRS.42A18.F1.br3.tr2.ox.ovary SRS.42A18HT1.Ago3IP.br1.tr1.ox.ovary SRS.42A18HT1.Ago3IP.br1.tr2.ox.ovary SRS.42A18HT1.AubIP.br1.tr1.ox.ovary SRS.42A18HT1.AubIP.br1.tr2.ox.ovary SRS.42A18HT1.PiwiIP.br1.tr1.ox.ovary SRS.42A18HT1.PiwiIP.br1.tr2.ox.ovary SRS.CC1.Ago3IP.br1.tr1.ox.ovary SRS.CC1.Ago3IP.br1.tr2.ox.ovary SRS.CC1.AubIP.br1.tr1.ox.ovary SRS.CC1.AubIP.br1.tr2.ox.ovary SRS.CC1.PiwiIP.br1.tr1.ox.ovary SRS.CC1.PiwiIP.br1.tr2.ox.ovary SRS.CC3.br1.tr1.ox.ovary SRS.CC3.br1.tr2.ox.ovary SRS.GS1AT1.br1.tr1.ox.ovary SRS.GS1AT1.br2.tr1.ox.ovary SRS.GS1AT1.br3.tr1.ox.ovary SRS.GS1BT1.28_31d.br1.tr1.ox.ovary SRS.GS1BT1.28_31d.br1.tr2.ox.ovary SRS.GS1BT1.28_31d.br2.tr1.ox.ovary SRS.GS1BT1.28_31d.br2.tr2.ox.ovary SRS.GS1BT1.28_31d.br3.tr1.ox.ovary SRS.GS1BT1.28_31d.br3.tr2.ox.ovary SRS.GS1BT1.br1.tr1.ox.ovary SRS.GS1BT1.br2.tr1.ox.ovary SRS.GS1BT1.br3.tr1.ox.ovary SRS.GS1CT1.Ago3IP.br1.tr1.ox.ovary SRS.GS1CT1.Ago3IP.br1.tr2.ox.ovary SRS.GS1CT1.AubIP.br1.tr1.ox.ovary SRS.GS1CT1.AubIP.br1.tr2.ox.ovary SRS.GS1CT1.br1.tr1.ox.ovary SRS.GS1CT1.br2.tr1.ox.ovary SRS.GS1CT1.br3.tr1.ox.ovary SRS.GS1CT1.br3.tr2.ox.ovary SRS.GS1CT1.PiwiIP.br1.tr1.ox.ovary SRS.GS1CT1.PiwiIP.br1.tr2.ox.ovary SRS.GS1DT1.br1.tr1.ox.ovary SRS.GS1DT1.br1.tr2.ox.ovary SRS.GS1DT1.br2.tr1.ox.ovary SRS.GS1DT1.br3.tr1.ox.ovary SRS.GS1ET1.br1.tr1.ox.ovary SRS.GS1ET1.br2.tr1.ox.ovary SRS.GS1ET1.br3.tr1.ox.ovary SRS.GS1.F18.br1.tr1.ox.ovary SRS.GS1.F18.br2.tr1.ox.ovary SRS.GS1.F18.br2.tr2.ox.ovary SRS.GS1.F18.br3.tr1.ox.ovary SRS.GS1.F1.br1.tr1.ox.ovary SRS.GS1.F1.br2.tr1.ox.ovary SRS.GS1.F1.br2.tr2.ox.ovary SRS.GS1.F1.br3.tr1.ox.ovary SRS.GS1.F1.br3.tr2.ox.ovary SRS.GS1FT1.br1.tr1.ox.ovary SRS.GS1FT1.br2.tr1.ox.ovary SRS.GS1FT1.br3.tr1.ox.ovary SRS.GS1FT1.br3.tr2.ox.ovary SRS.GS1GT1.br1.tr1.ox.ovary SRS.GS1GT1.br2.tr1.ox.ovary SRS.GS1GT1.br3.tr1.ox.ovary SRS.GS1HT1.Ago3IP.br1.tr1.ox.ovary SRS.GS1HT1.Ago3IP.br1.tr2.ox.ovary SRS.GS1HT1.AubIP.br1.tr1.ox.ovary SRS.GS1HT1.AubIP.br1.tr2.ox.ovary SRS.GS1HT1.PiwiIP.br1.tr1.ox.ovary SRS.GS1HT1.PiwiIP.br1.tr2.ox.ovary SRS.GS1JT1.br1.tr1.ox.ovary SRS.GS1JT1.br2.tr1.ox.ovary SRS.GS1JT1.br3.tr1.ox.ovary SRS.GS1JT2.br1.tr1.ox.ovary SRS.GS1JT2.br2.tr1.ox.ovary SRS.GS1JT2.br3.tr1.ox.ovary SRS.GS1JT3.br1.tr1.ox.ovary SRS.GS1JT3.br2.tr1.ox.ovary SRS.GS1JT3.br3.tr1.ox.ovary SRS.GS1JT4.br1.tr1.ox.ovary SRS.GS1JT4.br2.tr1.ox.ovary SRS.GS1JT4.br3.tr1.ox.ovary SRS.GS1AT1.br1.tr1.ox.ovary SRS.GS1AT1.br1.tr1.unox.ovary SRS.OR.br1.tr1.ox.testes SRS.OR.br1.tr1.unox.testes SRS.OR.br1.tr2.unox.testes SRS.XO.br1.tr1.ox.testes SRS.XO.br2.tr1.ox.testes SRS.XO.br2.tr2.ox.testes SRS.XO.br3.tr1.ox.testes SRS.XO.br3.tr2.ox.testes SRS.XO.br4.tr1.ox.testes SRS.XO.br4.tr2.ox.testes; do
# for D in $(find /home/fuy2/data/gfp_pirna/data -maxdepth 1 -name "SRS.*" -type d | sed 's|/home/fuy2/data/gfp_pirna/data/||' ); do
    # for D in SRS.GS1CT1.br2.tr1.ox.ovary SRS.GS1CT1.br3.tr1_2.ox.ovary SRS.GS1CT1.br3.tr1.ox.ovary SRS.GS1CT1.br3.tr2.ox.ovary; do
    # D=SRS.GS1CT1.br1.tr1.ox.ovary
    PREFIX=$D
    GCR_D=${D}/gene+cluster+repBase
    GCR_ALLMAP_BED2=${GCR_D}/${PREFIX}.gene+cluster+repBase.bed2
    PREFIX_COUNT=${GCR_D}/${PREFIX}.gene+cluster+repBase.bed2
    
    echo "awk '{ if(\$1 ~ /cluster|42AB|flam/) {c[\$1]+=\$4/\$5} } END{ for(i in c) { print i \"\t\" c[i] } }' ${GCR_ALLMAP_BED2} | sort -k1,1 > ${PREFIX_COUNT}.cluster.count"
    
    echo "awk '{ if(\$1 ~ /^FBgn/) {c[\$1]+=\$4/\$5} } END{ for(i in c) { print i \"\t\" c[i] } }' ${GCR_ALLMAP_BED2} | sort -k1,1 > ${PREFIX_COUNT}.repBase.count"
    
    echo "awk '{ if(\$1~/^NM_|^NR_/) {c[\$1]+=\$4/\$5} } END{ for(i in c) { print i \"\t\" c[i] } }' ${GCR_ALLMAP_BED2} | sort -k1,1 > ${PREFIX_COUNT}.gene.count"
    
    echo "awk '{if(\$1~/nos-gal4-vp16|GSV6|UASp-EGFP/) {c[\$1]+=\$4/\$5} } END{ for(i in c) { print i \"\t\" c[i] } }' ${GCR_ALLMAP_BED2} | sort -k1,1 > ${PREFIX_COUNT}.construct.count"
done
